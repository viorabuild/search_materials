# Estimate Checker Guide

Модуль `EstimateChecker` помогает сравнивать строительные сметы с мастер-листом и выявлять проблемы.

## Структура данных
- **Master List**: колонка `A` содержит коды (`M-SHF-001`, `M-WIN-042` и т.п.). Остальные колонки — описание, единицы измерения и т.д.
- **Estimate**: колонка `A` — код или ссылка на мастер-лист, колонка `B` — описание, колонка с количеством по умолчанию `F`.

## Основные проверки
- Пустые коды при наличии количества → пометка «СОЗДАТЬ КОД».
- Коды, отсутствующие в мастер-листе → список `missing_codes`.
- Дубликаты по коду внутри сметы → список `duplicates`.
- Подсчёт строк с количеством, пустых кодов и потенциальных новых позиций.

## Использование через агент
```python
from unified_agent import ConstructionAIAgent

agent = ConstructionAIAgent()
report = agent.check_estimate(
    estimate_sheet="Estimate",
    master_sheet="Master List",
    quantity_col="F",
)
print(report["summary"])
```

`ConstructionAIAgent` автоматически инициализирует `GoogleSheetsAI` (если заданы переменные `GOOGLE_SERVICE_ACCOUNT_FILE` и `GOOGLE_SHEET_ID`).

## Формулы
Метод `create_validation_formulas` возвращает словарь формул, которые можно вставить в Google Sheets для подсветки проблем: дубликаты, отсутствие кодов, следующий доступный индекс и т.д.

## Советы
- Если количество хранится в другой колонке, передайте `quantity_col="H"`.
- Для новых кодов используйте `generate_next_code`, чтобы автоматически предложить `M-SHF-0XX` или `M-WIN-0XX`.
- Комбинируйте проверки с локальными правилами (например, фильтрацией по категориям) через Python API.
